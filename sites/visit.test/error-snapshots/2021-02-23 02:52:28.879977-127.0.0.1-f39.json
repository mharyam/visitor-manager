{
 "etype": "OutgoingEmailError",
 "evalue": "OutgoingEmailError('Please setup default Email Account from Setup > Email > Email Account')",
 "exception": {
  "args": [
   40,
   39,
   80,
   108,
   101,
   97,
   115,
   101,
   32,
   115,
   101,
   116,
   117,
   112,
   32,
   100,
   101,
   102,
   97,
   117,
   108,
   116,
   32,
   69,
   109,
   97,
   105,
   108,
   32,
   65,
   99,
   99,
   111,
   117,
   110,
   116,
   32,
   102,
   114,
   111,
   109,
   32,
   83,
   101,
   116,
   117,
   112,
   32,
   62,
   32,
   69,
   109,
   97,
   105,
   108,
   32,
   62,
   32,
   69,
   109,
   97,
   105,
   108,
   32,
   65,
   99,
   99,
   111,
   117,
   110,
   116,
   39,
   44,
   41
  ],
  "http_status_code": [
   53,
   48,
   49
  ],
  "with_traceback": [
   60,
   98,
   117,
   105,
   108,
   116,
   45,
   105,
   110,
   32,
   109,
   101,
   116,
   104,
   111,
   100,
   32,
   119,
   105,
   116,
   104,
   95,
   116,
   114,
   97,
   99,
   101,
   98,
   97,
   99,
   107,
   32,
   111,
   102,
   32,
   79,
   117,
   116,
   103,
   111,
   105,
   110,
   103,
   69,
   109,
   97,
   105,
   108,
   69,
   114,
   114,
   111,
   114,
   32,
   111,
   98,
   106,
   101,
   99,
   116,
   62
  ]
 },
 "frames": [
  {
   "call": "(request=<Request 'http://visit.test:8001/api/method/frappe.desk.form.save.savedocs' [POST]>)",
   "dump": {
    "frappe. api": "<module 'frappe.api' from '/home/maryam/Documents/visitor/apps/frappe/frappe/api.py'>",
    "frappe.api. handle": "<function handle>",
    "global frappe": "<module 'frappe' from '/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py'>",
    "response": "None"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/app.py",
   "func": "application",
   "lines": {
    "65": "",
    "66": "\t\telif request.path.startswith(\"/api/\"):",
    "67": "\t\t\tresponse = frappe.api.handle()",
    "68": "",
    "69": "\t\telif request.path.startswith('/backups'):"
   },
   "lnum": 67
  },
  {
   "call": "()",
   "dump": {
    "frappe. handler": "<module 'frappe.handler' from '/home/maryam/Documents/visitor/apps/frappe/frappe/handler.py'>",
    "frappe.handler. handle": "<function handle>",
    "global frappe": "<module 'frappe' from '/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py'>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/api.py",
   "func": "handle",
   "lines": {
    "56": "\tif call==\"method\":",
    "57": "\t\tfrappe.local.form_dict.cmd = doctype",
    "58": "\t\treturn frappe.handler.handle()",
    "59": "",
    "60": "\telif call==\"resource\":"
   },
   "lnum": 58
  },
  {
   "call": "()",
   "dump": {
    "cmd": "'frappe.desk.form.save.savedocs'",
    "data": "None",
    "global execute_cmd": "<function execute_cmd>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/handler.py",
   "func": "handle",
   "lines": {
    "28": "",
    "29": "\tif cmd!='login':",
    "30": "\t\tdata = execute_cmd(cmd)",
    "31": "",
    "32": "\t# data can be an empty string or list which are valid responses"
   },
   "lnum": 30
  },
  {
   "call": "(cmd='frappe.desk.form.save.savedocs', from_async=False)",
   "dump": {
    "frappe. call": "<function call>",
    "frappe. form_dict": "{'doc': '{\"docstatus\":0,\"doctype\":\"Visit\",\"name\"... 'Save', 'cmd': 'frappe.desk.form.save.savedocs'}",
    "global frappe": "<module 'frappe' from '/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py'>",
    "method": "<function savedocs>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/handler.py",
   "func": "execute_cmd",
   "lines": {
    "68": "\tis_valid_http_method(method)",
    "69": "",
    "70": "\treturn frappe.call(method, **frappe.form_dict)",
    "71": "",
    "72": "def is_valid_http_method(method):"
   },
   "lnum": 70
  },
  {
   "call": "(fn=<function savedocs>, *args=(), **kwargs={'action': 'Save', 'cmd': 'frappe.desk.form.save.savedocs', 'doc': '{\"docstatus\":0,\"doctype\":\"Visit\",\"name\":\"new-vis...51:43\",\"time_of_departure\":\"2021-02-11 02:51:43\"}'})",
   "dump": {
    "args": "()",
    "fn": "<function savedocs>",
    "newargs": "{'action': 'Save', 'doc': '{\"docstatus\":0,\"doctype\":\"Visit\",\"name\":\"new-vis...51:43\",\"time_of_departure\":\"2021-02-11 02:51:43\"}'}"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py",
   "func": "call",
   "lines": {
    "1134": "\tnewargs = get_newargs(fn, kwargs)",
    "1135": "",
    "1136": "\treturn fn(*args, **newargs)",
    "1137": "",
    "1138": "def get_newargs(fn, kwargs):"
   },
   "lnum": 1136
  },
  {
   "call": "(doc=<visitor_management.visitor.doctype.visit.visit.Visit object>, action='Save')",
   "dump": {
    "doc": "<visitor_management.visitor.doctype.visit.visit.Visit object>",
    "doc. save": "<bound method Document.save of <visitor_management.visitor.doctype.visit.visit.Visit object>>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/desk/form/save.py",
   "func": "savedocs",
   "lines": {
    "19": "\t\t\tdoc.submit()",
    "20": "\t\telse:",
    "21": "\t\t\tdoc.save()",
    "22": "",
    "23": "\t\t# update recent documents"
   },
   "lnum": 21
  },
  {
   "call": "(self=<visitor_management.visitor.doctype.visit.visit.Visit object>, *args=(), **kwargs={})",
   "dump": {
    "args": "()",
    "kwargs": "{}",
    "self": "<visitor_management.visitor.doctype.visit.visit.Visit object>",
    "self. _save": "<bound method Document._save of <visitor_management.visitor.doctype.visit.visit.Visit object>>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py",
   "func": "save",
   "lines": {
    "283": "\tdef save(self, *args, **kwargs):",
    "284": "\t\t\"\"\"Wrapper for _save\"\"\"",
    "285": "\t\treturn self._save(*args, **kwargs)",
    "286": "",
    "287": "\tdef _save(self, ignore_permissions=None, ignore_version=None):"
   },
   "lnum": 285
  },
  {
   "call": "(self=<visitor_management.visitor.doctype.visit.visit.Visit object>, ignore_permissions=None, ignore_version=None)",
   "dump": {
    "self": "<visitor_management.visitor.doctype.visit.visit.Visit object>",
    "self. insert": "<bound method Document.insert of <visitor_management.visitor.doctype.visit.visit.Visit object>>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py",
   "func": "_save",
   "lines": {
    "305": "",
    "306": "\t\tif self.get(\"__islocal\") or not self.get(\"name\"):",
    "307": "\t\t\tself.insert()",
    "308": "\t\t\treturn",
    "309": ""
   },
   "lnum": 307
  },
  {
   "call": "(self=<visitor_management.visitor.doctype.visit.visit.Visit object>, ignore_permissions=None, ignore_links=None, ignore_if_duplicate=False, ignore_mandatory=None, set_name=None, set_child_names=True)",
   "dump": {
    "self": "<visitor_management.visitor.doctype.visit.visit.Visit object>",
    "self. run_method": "<bound method Document.run_method of <visitor_management.visitor.doctype.visit.visit.Visit object>>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py",
   "func": "insert",
   "lines": {
    "257": "\t\t\td.db_insert()",
    "258": "",
    "259": "\t\tself.run_method(\"after_insert\")",
    "260": "\t\tself.flags.in_insert = True",
    "261": ""
   },
   "lnum": 259
  },
  {
   "call": "(self=<visitor_management.visitor.doctype.visit.visit.Visit object>, method='after_insert', *args=(), **kwargs={})",
   "dump": {
    "Document. hook": "<function Document.hook>",
    "args": "()",
    "fn": "<function Document.run_method.<locals>.<lambda>>",
    "global Document": "<class 'frappe.model.document.Document'>",
    "kwargs": "{}",
    "out": "undefined",
    "self": "<visitor_management.visitor.doctype.visit.visit.Visit object>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py",
   "func": "run_method",
   "lines": {
    "846": "",
    "847": "\t\tfn.__name__ = str(method)",
    "848": "\t\tout = Document.hook(fn)(self, *args, **kwargs)",
    "849": "",
    "850": "\t\tself.run_notifications(method)"
   },
   "lnum": 848
  },
  {
   "call": "(self=<visitor_management.visitor.doctype.visit.visit.Visit object>, *args=(), **kwargs={})",
   "dump": {
    "args": "()",
    "composed": "<function Document.hook.<locals>.compose.<locals>.runner>",
    "kwargs": "{}",
    "method": "'after_insert'",
    "self": "<visitor_management.visitor.doctype.visit.visit.Visit object>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py",
   "func": "composer",
   "lines": {
    "1135": "",
    "1136": "\t\t\tcomposed = compose(f, *hooks)",
    "1137": "\t\t\treturn composed(self, method, *args, **kwargs)",
    "1138": "",
    "1139": "\t\treturn composer"
   },
   "lnum": 1137
  },
  {
   "call": "(self=<visitor_management.visitor.doctype.visit.visit.Visit object>, method='after_insert', *args=(), **kwargs={})",
   "dump": {
    "add_to_return_value": "<function Document.hook.<locals>.add_to_return_value>",
    "args": "()",
    "fn": "<function Document.run_method.<locals>.<lambda>>",
    "kwargs": "{}",
    "self": "<visitor_management.visitor.doctype.visit.visit.Visit object>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py",
   "func": "runner",
   "lines": {
    "1118": "\t\tdef compose(fn, *hooks):",
    "1119": "\t\t\tdef runner(self, method, *args, **kwargs):",
    "1120": "\t\t\t\tadd_to_return_value(self, fn(self, *args, **kwargs))",
    "1121": "\t\t\t\tfor f in hooks:",
    "1122": "\t\t\t\t\tadd_to_return_value(self, f(self, method, *args, **kwargs))"
   },
   "lnum": 1120
  },
  {
   "call": "(self=<visitor_management.visitor.doctype.visit.visit.Visit object>, *args=(), **kwargs={})",
   "dump": {
    "args": "()",
    "builtin getattr": "<built-in function getattr>",
    "fn": "undefined",
    "kwargs": "{}",
    "method": "'after_insert'",
    "self": "<visitor_management.visitor.doctype.visit.visit.Visit object>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py",
   "func": "<lambda>",
   "lines": {
    "840": "",
    "841": "\t\tif hasattr(self, method) and hasattr(getattr(self, method), \"__call__\"):",
    "842": "\t\t\tfn = lambda self, *args, **kwargs: getattr(self, method)(*args, **kwargs)",
    "843": "\t\telse:",
    "844": "\t\t\t# hack! to run hooks even if method does not exist"
   },
   "lnum": 842
  },
  {
   "call": "(self=<visitor_management.visitor.doctype.visit.visit.Visit object>)",
   "dump": {
    "frappe. sendmail": "<function sendmail>",
    "global frappe": "<module 'frappe' from '/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py'>",
    "message": "undefined",
    "recipients": "undefined",
    "self": "<visitor_management.visitor.doctype.visit.visit.Visit object>",
    "self. email": "'maryam.m.yusuf1802@gmail.com'",
    "self. otp": "'992596'",
    "subject": "undefined"
   },
   "file": "/home/maryam/Documents/visitor/apps/visitor_management/visitor_management/visitor/doctype/visit/visit.py",
   "func": "after_insert",
   "lines": {
    "22": "    def after_insert(self):",
    "23": "        if self.email:",
    "24": "            frappe.sendmail(",
    "25": "            recipients= [self.email],",
    "26": "            subject = \"Visit Infomation \","
   },
   "lnum": 24
  },
  {
   "call": "(recipients=['maryam.m.yusuf1802@gmail.com'], sender='', subject='Visit Infomation ', message='Your unique 6 digit number is 992596', as_markdown=False, delayed=True, reference_doctype=None, reference_name=None, unsubscribe_method=None, unsubscribe_params=None, unsubscribe_message=None, attachments=None, content=None, doctype=None, name=None, reply_to=None, cc=[], bcc=[], message_id=None, in_reply_to=None, send_after=None, expose_recipients=None, send_priority=1, communication=None, retry=1, now=None, read_receipt=None, is_notification=False, inline_images=None, template=None, args=None, header=None, print_letterhead=False, with_container=False)",
   "dump": {
    "attachments": "None",
    "bcc": "[]",
    "cc": "[]",
    "communication": "None",
    "doctype": "None",
    "expose_recipients": "None",
    "header": "None",
    "in_reply_to": "None",
    "inline_images": "None",
    "is_notification": "False",
    "message": "'Your unique 6 digit number is 992596'",
    "message_id": "None",
    "name": "None",
    "now": "None",
    "print_letterhead": "False",
    "queue": "<module 'frappe.email.queue' from '/home/maryam/...ments/visitor/apps/frappe/frappe/email/queue.py'>",
    "queue. send": "<function send>",
    "read_receipt": "None",
    "recipients": "['maryam.m.yusuf1802@gmail.com']",
    "reference_doctype": "None",
    "reference_name": "None",
    "reply_to": "None",
    "send_after": "None",
    "send_priority": "1",
    "sender": "''",
    "subject": "'Visit Infomation '",
    "text_content": "None",
    "unsubscribe_message": "None",
    "unsubscribe_method": "None",
    "unsubscribe_params": "None",
    "with_container": "False"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py",
   "func": "sendmail",
   "lines": {
    "515": "",
    "516": "\tfrom frappe.email import queue",
    "517": "\tqueue.send(recipients=recipients, sender=sender,",
    "518": "\t\tsubject=subject, message=message, text_content=text_content,",
    "519": "\t\treference_doctype = doctype or reference_doctype, reference_name = name or reference_name,"
   },
   "lnum": 517
  },
  {
   "call": "(recipients=['maryam.m.yusuf1802@gmail.com'], sender='', subject='Visit Infomation ', message='Your unique 6 digit number is 992596', text_content=None, reference_doctype=None, reference_name=None, unsubscribe_method='/api/method/frappe.email.queue.unsubscribe', unsubscribe_params=None, unsubscribe_message=None, attachments=None, reply_to=None, cc=[], bcc=[], message_id=None, in_reply_to=None, send_after=None, expose_recipients=None, send_priority=1, communication=None, now=None, read_receipt=None, queue_separately=False, is_notification=False, add_unsubscribe_link=1, inline_images=None, header=None, print_letterhead=False, with_container=False)",
   "dump": {
    "append_to": "undefined",
    "email_account": "undefined",
    "global get_outgoing_email_account": "<function get_outgoing_email_account>",
    "reference_doctype": "None",
    "sender": "''"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/email/queue.py",
   "func": "send",
   "lines": {
    "74": "\t\tsend_after = add_days(nowdate(), send_after)",
    "75": "",
    "76": "\temail_account = get_outgoing_email_account(True, append_to=reference_doctype, sender=sender)",
    "77": "\tif not sender or sender == \"Administrator\":",
    "78": "\t\tsender = email_account.default_sender"
   },
   "lnum": 76
  },
  {
   "call": "(raise_exception_not_set=True, append_to=None, sender='')",
   "dump": {
    "frappe. OutgoingEmailError": "<class 'frappe.exceptions.OutgoingEmailError'>",
    "frappe. throw": "<function throw>",
    "global _": "<function _>",
    "global frappe": "<module 'frappe' from '/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py'>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/email/smtp.py",
   "func": "get_outgoing_email_account",
   "lines": {
    "87": "",
    "88": "\t\tif not email_account and raise_exception_not_set and cint(frappe.db.get_single_value('System Settings', 'setup_complete')):",
    "89": "\t\t\tfrappe.throw(_(\"Please setup default Email Account from Setup > Email > Email Account\"),",
    "90": "\t\t\t\tfrappe.OutgoingEmailError)",
    "91": ""
   },
   "lnum": 89
  },
  {
   "call": "(msg='Please setup default Email Account from Setup > Email > Email Account', exc=<class 'frappe.exceptions.OutgoingEmailError'>, title=None, is_minimizable=None, wide=None, as_list=False)",
   "dump": {
    "as_list": "False",
    "exc": "<class 'frappe.exceptions.OutgoingEmailError'>",
    "global msgprint": "<function msgprint>",
    "indicator": "undefined",
    "is_minimizable": "None",
    "msg": "'Please setup default Email Account from Setup > Email > Email Account'",
    "raise_exception": "undefined",
    "title": "None",
    "wide": "None"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py",
   "func": "throw",
   "lines": {
    "414": "\t:param msg: Message.",
    "415": "\t:param exc: Exception class. Default `frappe.ValidationError`\"\"\"",
    "416": "\tmsgprint(msg, raise_exception=exc, title=title, indicator='red', is_minimizable=is_minimizable, wide=wide, as_list=as_list)",
    "417": "",
    "418": "def emit_js(js, user=False, **kwargs):"
   },
   "lnum": 416
  },
  {
   "call": "(msg='Please setup default Email Account from Setup > Email > Email Account', title=None, raise_exception=<class 'frappe.exceptions.OutgoingEmailError'>, as_table=False, as_list=False, indicator='red', alert=False, primary_action=None, is_minimizable=None, wide=None)",
   "dump": {
    "_raise_exception": "<function msgprint.<locals>._raise_exception>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py",
   "func": "msgprint",
   "lines": {
    "393": "\t\tlocal.response['exc_type'] = raise_exception.__name__",
    "394": "",
    "395": "\t_raise_exception()",
    "396": "",
    "397": "def clear_messages():"
   },
   "lnum": 395
  },
  {
   "call": "()",
   "dump": {
    "msg": "'Please setup default Email Account from Setup > Email > Email Account'",
    "raise_exception": "<class 'frappe.exceptions.OutgoingEmailError'>"
   },
   "file": "/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py",
   "func": "_raise_exception",
   "lines": {
    "347": "",
    "348": "\t\t\tif inspect.isclass(raise_exception) and issubclass(raise_exception, Exception):",
    "349": "\t\t\t\traise raise_exception(msg)",
    "350": "\t\t\telse:",
    "351": "\t\t\t\traise ValidationError(msg)"
   },
   "lnum": 349
  }
 ],
 "locals": {
  "inspect": "<module 'inspect' from '/usr/lib/python3.8/inspect.py'>",
  "msg": "Please setup default Email Account from Setup > Email > Email Account",
  "raise_exception": "<class 'frappe.exceptions.OutgoingEmailError'>"
 },
 "pyver": "Python 3.8.5: /home/maryam/Documents/visitor/env/bin/python (prefix: /home/maryam/Documents/visitor/env)",
 "timestamp": "2021-02-23 02:52:28.890262",
 "traceback": "Traceback (most recent call last):\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/app.py\", line 67, in application\n    response = frappe.api.handle()\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/api.py\", line 58, in handle\n    return frappe.handler.handle()\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/handler.py\", line 30, in handle\n    data = execute_cmd(cmd)\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/handler.py\", line 70, in execute_cmd\n    return frappe.call(method, **frappe.form_dict)\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py\", line 1136, in call\n    return fn(*args, **newargs)\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/desk/form/save.py\", line 21, in savedocs\n    doc.save()\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py\", line 285, in save\n    return self._save(*args, **kwargs)\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py\", line 307, in _save\n    self.insert()\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py\", line 259, in insert\n    self.run_method(\"after_insert\")\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py\", line 848, in run_method\n    out = Document.hook(fn)(self, *args, **kwargs)\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py\", line 1137, in composer\n    return composed(self, method, *args, **kwargs)\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py\", line 1120, in runner\n    add_to_return_value(self, fn(self, *args, **kwargs))\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/model/document.py\", line 842, in <lambda>\n    fn = lambda self, *args, **kwargs: getattr(self, method)(*args, **kwargs)\n  File \"/home/maryam/Documents/visitor/apps/visitor_management/visitor_management/visitor/doctype/visit/visit.py\", line 24, in after_insert\n    frappe.sendmail(\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py\", line 517, in sendmail\n    queue.send(recipients=recipients, sender=sender,\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/email/queue.py\", line 76, in send\n    email_account = get_outgoing_email_account(True, append_to=reference_doctype, sender=sender)\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/email/smtp.py\", line 89, in get_outgoing_email_account\n    frappe.throw(_(\"Please setup default Email Account from Setup > Email > Email Account\"),\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py\", line 416, in throw\n    msgprint(msg, raise_exception=exc, title=title, indicator='red', is_minimizable=is_minimizable, wide=wide, as_list=as_list)\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py\", line 395, in msgprint\n    _raise_exception()\n  File \"/home/maryam/Documents/visitor/apps/frappe/frappe/__init__.py\", line 349, in _raise_exception\n    raise raise_exception(msg)\nfrappe.exceptions.OutgoingEmailError: Please setup default Email Account from Setup > Email > Email Account\n"
}